{"version":3,"file":"1.js","sources":["webpack:///./utils/api/article.js","webpack:///./utils/api/user.js","webpack:///./utils/support.js","webpack:///./components/pagenation.vue?4458","webpack:///./components/pagenation.vue","webpack:///./components/pagenation.vue?af22","webpack:///./components/pagenation.vue?0379","webpack:///./pages/profile.vue?5519","webpack:///./pages/profile.vue","webpack:///./pages/profile.vue?0be0","webpack:///./pages/profile.vue?9213"],"sourcesContent":["import { request } from \"../../plugins/request\";\nexport const ArticleApi = {\n  articleList(params, type = \"global\") {\n    if (type === \"feed\") {\n      return request({\n        url: \"/api/articles/feed\",\n        params,\n        method: \"GET\",\n      });\n    }\n    return request({\n      url: \"/api/articles\",\n      params,\n      method: \"GET\",\n    });\n  },\n  getTags() {\n    return request({\n      method: \"GET\",\n      url: \"/api/tags\",\n    });\n  },\n  favor(slug) {\n    return request({\n      method: \"POST\",\n      url: `/api/articles/${slug}/favorite`,\n    });\n  },\n  unfavor(slug) {\n    return request({\n      method: \"DELETE\",\n      url: `/api/articles/${slug}/favorite`,\n    });\n  },\n  getArticle(slug) {\n    return request({\n      method: \"GET\",\n      url: `/api/articles/${slug}`,\n    });\n  },\n  createArticle(article) {\n    return request({\n      method: \"POST\",\n      url: `/api/articles`,\n      data: {\n        article,\n      },\n    });\n  },\n  delArticle(slug) {\n    return request({\n        method: \"DELETE\",\n        url: `/api/articles/${slug}`,\n    });\n  },\n  updateArticle(article, slug) {\n    return request({\n        method: \"PUT\",\n        url: `/api/articles/${slug}`,\n        data: {\n            article,\n          },\n    });\n  },\n  addComment(comment, slug) {\n    return request({\n      method: \"POST\",\n      url: `/api/articles/${slug}/comments`,\n      data: {\n        comment: {\n          body: comment,\n        },\n      },\n    });\n  },\n  getComment(slug) {\n    return request({\n      method: \"GET\",\n      url: `/api/articles/${slug}/comments`,\n    });\n  },\n  delComment(slug, id) {\n    return request({\n      method: \"DELETE\",\n      url: `/api/articles/${slug}/comments/${id}`,\n    });\n  },\n};\n","import {request} from '../../plugins/request'\nexport const UserApi = {\n    login(params) {\n        return request({\n            url: '/api/users/login',\n            data: {user: params},\n            method:'POST',\n        })\n    },\n    register(params){\n        return request({\n            url: '/api/users',\n            data: {user: params},\n            method:'POST',\n        })\n    },\n    updateUser(user) {\n        return request({\n            url: '/api/user',\n            method:'PUT',\n            data: {\n                user\n            }\n        })\n    },\n    getUser() {\n        return request({\n            url: '/api/user',\n            method:'GET',\n        })\n    },\n    getProfile(username){\n        return request({\n            url: '/api/profiles/'+username,\n            method:'GET',\n        })\n    },\n    followUser(username) {\n       return request({\n        url: `/api/profiles/${username}/follow`,\n        method:'POST',\n       })\n    },\n    unfollowUser(username) {\n       return request({\n        url: `/api/profiles/${username}/follow`,\n        method:'DELETE',\n       })\n    },\n}","import Cookie from 'js-cookie';\n\n\nexport function extraObj (obj,fields) {\n   return fields.reduce((_,field) => {\n        _[field] = obj[field];\n        return _\n   },{});\n}\n// 获取错误信息\nexport function getErrorMsg(error) {\n   const {errors} =error\n   if(errors){\n     const errorArr = Object.keys(errors).reduce((_, key) => {\n          _.push(`${key}:`+errors[key].join(','));\n          return _;\n     }, []);\n     if(errorArr.length > 0){\n         return errorArr\n     }\n   }\n   return undefined;\n}\n\nexport function getToken() {\n    let  token;\n    if(process.server){\n        \n    }\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('nav',[_vm._ssrNode(\"<ul class=\\\"pagination\\\">\"+(_vm._ssrList((_vm.pageTotal),function(index){return (\"<li\"+(_vm._ssrClass(\"page-item \",{ active: _vm.currentIndex == index }))+\"><span class=\\\"page-link ng-binding\\\">\"+_vm._ssrEscape(_vm._s(index))+\"</span></li>\")}))+\"</ul>\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  name: \"pagenation\",\n  props: {\n    total: {\n      type: Number,\n      default: 0,\n    },\n    limit: {\n      type: Number,\n      default: 20,\n    },\n  },\n  data() {\n    return {\n      currentIndex: 1,\n    };\n  },\n  methods: {\n    change(index) {\n      this.currentIndex = index;\n      this.$emit(\"changePage\", index);\n    },\n    reset() {\n        this.currentIndex = 1;\n    }\n  },\n  computed: {\n    pageTotal() {\n      return Math.ceil(this.total / this.limit);\n    },\n  },\n};\n","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./pagenation.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./pagenation.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./pagenation.vue?vue&type=template&id=2250037e&\"\nimport script from \"./pagenation.vue?vue&type=script&lang=js&\"\nexport * from \"./pagenation.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  \"56e0af66\"\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"profile-page\"},[_vm._ssrNode(\"<div class=\\\"user-info\\\"><div class=\\\"container\\\"><div class=\\\"row\\\"><div class=\\\"col-xs-12 col-md-10 offset-md-1\\\"><img\"+(_vm._ssrAttr(\"src\",_vm.user.image))+\" class=\\\"user-img\\\"> <h4>\"+_vm._ssrEscape(_vm._s(_vm.user.username))+\"</h4> <p>\"+_vm._ssrEscape(\"\\n            \"+_vm._s(_vm.user.bio)+\"\\n          \")+\"</p> <button\"+(_vm._ssrClass(\"btn btn-sm btn-outline-secondary action-btn\",{active: _vm.user.following}))+\"><i class=\\\"ion-plus-round\\\"></i>\"+_vm._ssrEscape(\"\\n              \\n             \"+_vm._s(_vm.user.following\n              ? \"UnFollow \" + _vm.user.username\n              : \"Follow \" + _vm.user.username)+\"\\n          \")+\"</button></div></div></div></div> \"),_vm._ssrNode(\"<div class=\\\"container\\\">\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"row\\\">\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"col-xs-12 col-md-10 offset-md-1\\\">\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"articles-toggle\\\"><ul class=\\\"nav nav-pills outline-active\\\"><li class=\\\"nav-item\\\"><span href\"+(_vm._ssrClass(\"nav-link \",{active: _vm.active === 'author'}))+\">My Articles</span></li> <li class=\\\"nav-item\\\"><span href\"+(_vm._ssrClass(\"nav-link\",{active: _vm.active === 'favorited'}))+\">Favorited Articles</span></li></ul></div> \"),_vm._l((_vm.articles),function(article,index){return _vm._ssrNode(\"<div class=\\\"article-preview\\\">\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"article-meta\\\">\",\"</div>\",[_c('nuxt-link',{attrs:{\"to\":(\"/profile/\" + (article.author.username))}},[_c('img',{attrs:{\"src\":article.author.image}})]),_vm._ssrNode(\" \"),_vm._ssrNode(\"<div class=\\\"info\\\">\",\"</div>\",[_c('nuxt-link',{staticClass:\"author\",attrs:{\"to\":(\"/profile/\" + (article.author.username))}},[_vm._v(_vm._s(article.author.username))]),_vm._ssrNode(\" <span class=\\\"date\\\">\"+_vm._ssrEscape(_vm._s(article.author.createdAt))+\"</span>\")],2),_vm._ssrNode(\" <button\"+(_vm._ssrClass(\"btn btn-outline-primary btn-sm pull-xs-right\",{active: article.favorited}))+\"><i class=\\\"ion-heart\\\"></i>\"+_vm._ssrEscape(\" \"+_vm._s(article.favoritesCount)+\"\\n            \")+\"</button>\")],2),_vm._ssrNode(\" \"),_c('nuxt-link',{staticClass:\"preview-link\",attrs:{\"to\":(\"/article/\" + (article.slug))}},[_c('h1',[_vm._v(_vm._s(article.title))]),_vm._v(\" \"),_c('p',[_vm._v(_vm._s(article.description))]),_vm._v(\" \"),_c('span',[_vm._v(\"Read more...\")])])],2)}),_vm._ssrNode(\" \"),_c('Pagenation',{ref:\"pagination\",attrs:{\"total\":_vm.articlesCount,\"limit\":_vm.params.limit},on:{\"changePage\":_vm.changePage}})],2)])])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { ArticleApi } from \"../utils/api/article\";\nimport { UserApi } from \"../utils/api/user\";\nimport { extraObj } from \"../utils/support\";\nimport Pagenation from '@/components/pagenation'\nexport default {\n  data () {\n    return {\n      active: 'author'\n    }\n  },\n  components: {\n   Pagenation,\n  },\n  async asyncData({ route }) {\n    const author = route.params.username;\n    const articleRes = await ArticleApi.articleList({ author: author });\n    const profileRes = await UserApi.getProfile(author);\n    return {\n      articles: articleRes.data.articles,\n      articlesCount: articleRes.data.articlesCount,\n      params: {\n        author,\n        favorited: author,\n        limit: 20, offset: 0,\n      },\n      user: profileRes.data.profile,\n    };\n  },\n  methods: {\n    async getArticles(type) {\n      const params = extraObj(this.params, [type]);\n      this.active = type\n      const { data } = await ArticleApi.articleList(params);\n      this.articles = data.articles;\n      this.articlesCount = data.articlesCount;\n    },\n    async toFavor(article,index) {\n      let favorApiName = \"favor\";\n      if (article.favorited) {\n        favorApiName = \"unfavor\";\n      }\n      const { data } = await ArticleApi[favorApiName](article.slug);\n      if (data && data.article) {\n        this.articles.splice(index,1,data.article)\n      }\n    },\n    changeArticleType(type) {\n      this.params.offset = 0;\n      this.getArticles(type);\n        this.resetPagination();\n      \n    },\n    async toFollow() {\n      let followApiName = \"followUser\";\n      if (this.user.following) {\n        followApiName = \"unfollowUser\";\n      }\n      const { data } = await UserApi[followApiName](this.user.username);\n      if (data && data.profile) {\n        this.user.following = data.profile.following\n      }\n    },\n    changePage(index){ \n      this.params.offset = (index - 1) * this.params.limit;\n      this.getArticles(this.type);\n    },\n      resetPagination(){\n       const ref = this.$refs.pagination;\n       ref && ref.reset();\n    },\n  },\n};\n","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./profile.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./profile.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./profile.vue?vue&type=template&id=18ab83d0&\"\nimport script from \"./profile.vue?vue&type=script&lang=js&\"\nexport * from \"./profile.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  \"2e16d215\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAAA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AADA;AAHA;AAOA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AADA;AAHA;AAOA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AADA;AAHA;AASA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAtFA;;;;;;;;ACDA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAHA;AAKA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAHA;AAKA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AADA;AAHA;AAOA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAhDA;;;;;;;;ACDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AAAA;AAGA;;;;;;;;;;AC7BA;AACA;AACA;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AALA;AACA;AASA;AACA;AACA;AADA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AARA;AASA;AACA;AACA;AACA;AACA;AAJA;AA1BA;;AChBA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACrBA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AAAA;AACA;AADA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAHA;AAKA;AARA;AAUA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AA1CA;AAxBA;;ACzEA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}