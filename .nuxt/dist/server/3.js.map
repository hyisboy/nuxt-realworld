{"version":3,"file":"3.js","sources":["webpack:///./utils/api/article.js","webpack:///./utils/support.js","webpack:///./pages/article-form.vue?96e0","webpack:///./pages/article-form.vue","webpack:///./pages/article-form.vue?3baa","webpack:///./pages/article-form.vue?86ad"],"sourcesContent":["import { request } from \"../../plugins/request\";\nexport const ArticleApi = {\n  articleList(params, type = \"global\") {\n    if (type === \"feed\") {\n      return request({\n        url: \"/api/articles/feed\",\n        params,\n        method: \"GET\",\n      });\n    }\n    return request({\n      url: \"/api/articles\",\n      params,\n      method: \"GET\",\n    });\n  },\n  getTags() {\n    return request({\n      method: \"GET\",\n      url: \"/api/tags\",\n    });\n  },\n  favor(slug) {\n    return request({\n      method: \"POST\",\n      url: `/api/articles/${slug}/favorite`,\n    });\n  },\n  unfavor(slug) {\n    return request({\n      method: \"DELETE\",\n      url: `/api/articles/${slug}/favorite`,\n    });\n  },\n  getArticle(slug) {\n    return request({\n      method: \"GET\",\n      url: `/api/articles/${slug}`,\n    });\n  },\n  createArticle(article) {\n    return request({\n      method: \"POST\",\n      url: `/api/articles`,\n      data: {\n        article,\n      },\n    });\n  },\n  delArticle(slug) {\n    return request({\n        method: \"DELETE\",\n        url: `/api/articles/${slug}`,\n    });\n  },\n  updateArticle(article, slug) {\n    return request({\n        method: \"PUT\",\n        url: `/api/articles/${slug}`,\n        data: {\n            article,\n          },\n    });\n  },\n  addComment(comment, slug) {\n    return request({\n      method: \"POST\",\n      url: `/api/articles/${slug}/comments`,\n      data: {\n        comment: {\n          body: comment,\n        },\n      },\n    });\n  },\n  getComment(slug) {\n    return request({\n      method: \"GET\",\n      url: `/api/articles/${slug}/comments`,\n    });\n  },\n  delComment(slug, id) {\n    return request({\n      method: \"DELETE\",\n      url: `/api/articles/${slug}/comments/${id}`,\n    });\n  },\n};\n","import Cookie from 'js-cookie';\n\n\nexport function extraObj (obj,fields) {\n   return fields.reduce((_,field) => {\n        _[field] = obj[field];\n        return _\n   },{});\n}\n// 获取错误信息\nexport function getErrorMsg(error) {\n   const {errors} =error\n   if(errors){\n     const errorArr = Object.keys(errors).reduce((_, key) => {\n          _.push(`${key}:`+errors[key].join(','));\n          return _;\n     }, []);\n     if(errorArr.length > 0){\n         return errorArr\n     }\n   }\n   return undefined;\n}\n\nexport function getToken() {\n    let  token;\n    if(process.server){\n        \n    }\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"editor-page\"},[_vm._ssrNode(\"<div class=\\\"container page\\\"><div class=\\\"row\\\"><div class=\\\"col-md-10 offset-md-1 col-xs-12\\\"><ul class=\\\"error-messages\\\">\"+(_vm._ssrList((_vm.errorList),function(errText){return (\"<li>\"+_vm._ssrEscape(_vm._s(errText))+\"</li>\")}))+\"</ul> <form><fieldset class=\\\"form-group\\\"><input type=\\\"text\\\" placeholder=\\\"Article Title\\\"\"+(_vm._ssrAttr(\"value\",(_vm.form.title)))+\" class=\\\"form-control form-control-lg\\\"></fieldset> <fieldset class=\\\"form-group\\\"><input type=\\\"text\\\" placeholder=\\\"What's this article about?\\\"\"+(_vm._ssrAttr(\"value\",(_vm.form.description)))+\" class=\\\"form-control\\\"></fieldset> <fieldset class=\\\"form-group\\\"><textarea rows=\\\"8\\\" placeholder=\\\"Write your article (in markdown)\\\" class=\\\"form-control\\\">\"+_vm._ssrEscape(_vm._s(_vm.form.body))+\"</textarea></fieldset> <fieldset class=\\\"form-group\\\"><input type=\\\"text\\\" placeholder=\\\"enter tag\\\"\"+(_vm._ssrAttr(\"value\",(_vm.tag)))+\" class=\\\"form-control\\\"> <div class=\\\"tag-list\\\">\"+(_vm._ssrList((_vm.form.tagList),function(tag){return (\"<span ng-repeat=\\\"tag in $ctrl.article.tagList\\\" class=\\\"tag-default tag-pill ng-binding ng-scope\\\"><i class=\\\"ion-close-round\\\"></i>\"+_vm._ssrEscape(\"\\n                  \"+_vm._s(tag)+\"\\n                \")+\"</span>\")}))+\"</div></fieldset> <button type=\\\"button\\\" class=\\\"btn btn-lg pull-xs-right btn-primary\\\">\\n              Publish Article\\n            </button></form></div></div></div>\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { ArticleApi } from \"@/utils/api/article\";\nimport { getErrorMsg } from \"@/utils/support\";\nexport default {\n  middleware: [\"auth\"],\n  data() {\n    return {\n      form: {\n        title: \"\",\n        description: \"\",\n        body: \"\",\n        tagList: [],\n      },\n      errorList: [],\n      isEditor: false,\n      slug: \"\",\n      tag: \"\",\n    };\n  },\n  async created() {\n    const { slug } = this.$route.query;\n    if (slug) {\n      const { data } = await ArticleApi.getArticle(slug);\n      this.isEditor = true;\n      this.slug = slug;\n      if (data) {\n        const { title, body, description, tagList } = data.article;\n        this.form = { title, body, description, tagList: tagList };\n      }\n    }\n  },\n  methods: {\n    async submit() {\n      const form = Object.assign(this.form);\n      const API_NAME = this.isEditor ? \"updateArticle\" : \"createArticle\";\n      const { data } = await ArticleApi[API_NAME](form, this.slug).catch(\n        (err) => {\n          const error = getErrorMsg(err.data);\n          if (error) {\n            this.errorList = error;\n          }\n          return Promise.resolve({})\n        }\n      );\n      if (data && data.article) {\n        const username = this.$store.state.user.user.username;\n        this.$router.replace(`/article/${data.article.slug}?uname=${username}`);\n      }\n    },\n    removeTag(tag) {\n      const list = this.form.tagList;\n      const index = list.indexOf(tag);\n      list.splice(index,1);\n    },\n    addTag() {\n      if(typeof this.tag != 'number' && !this.tag)return;\n      const list = this.form.tagList;\n      if (!list.includes(this.tag)) {\n        list.push(this.tag);\n      }\n      this.tag = \"\";\n    },\n  },\n};\n","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./article-form.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./article-form.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./article-form.vue?vue&type=template&id=3851d362&\"\nimport script from \"./article-form.vue?vue&type=script&lang=js&\"\nexport * from \"./article-form.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  \"48e36a7f\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAAA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AADA;AAHA;AAOA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AADA;AAHA;AAOA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AADA;AAHA;AASA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAtFA;;;;;;;;ACDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AAAA;AAGA;;;;;;;;;;;;AC7BA;AACA;AACA;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AAVA;AAYA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AA/BA;AA5BA;;ACjEA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}