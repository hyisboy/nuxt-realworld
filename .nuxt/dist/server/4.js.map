{"version":3,"file":"4.js","sources":["webpack:///./utils/api/article.js","webpack:///./components/pagenation.vue?4458","webpack:///./components/pagenation.vue","webpack:///./components/pagenation.vue?af22","webpack:///./components/pagenation.vue?0379","webpack:///./pages/index.vue?c3dd","webpack:///./pages/index.vue","webpack:///./pages/index.vue?ff57","webpack:///./pages/index.vue?b7d3"],"sourcesContent":["import { request } from \"../../plugins/request\";\nexport const ArticleApi = {\n  articleList(params, type = \"global\") {\n    if (type === \"feed\") {\n      return request({\n        url: \"/api/articles/feed\",\n        params,\n        method: \"GET\",\n      });\n    }\n    return request({\n      url: \"/api/articles\",\n      params,\n      method: \"GET\",\n    });\n  },\n  getTags() {\n    return request({\n      method: \"GET\",\n      url: \"/api/tags\",\n    });\n  },\n  favor(slug) {\n    return request({\n      method: \"POST\",\n      url: `/api/articles/${slug}/favorite`,\n    });\n  },\n  unfavor(slug) {\n    return request({\n      method: \"DELETE\",\n      url: `/api/articles/${slug}/favorite`,\n    });\n  },\n  getArticle(slug) {\n    return request({\n      method: \"GET\",\n      url: `/api/articles/${slug}`,\n    });\n  },\n  createArticle(article) {\n    return request({\n      method: \"POST\",\n      url: `/api/articles`,\n      data: {\n        article,\n      },\n    });\n  },\n  delArticle(slug) {\n    return request({\n        method: \"DELETE\",\n        url: `/api/articles/${slug}`,\n    });\n  },\n  updateArticle(article, slug) {\n    return request({\n        method: \"PUT\",\n        url: `/api/articles/${slug}`,\n        data: {\n            article,\n          },\n    });\n  },\n  addComment(comment, slug) {\n    return request({\n      method: \"POST\",\n      url: `/api/articles/${slug}/comments`,\n      data: {\n        comment: {\n          body: comment,\n        },\n      },\n    });\n  },\n  getComment(slug) {\n    return request({\n      method: \"GET\",\n      url: `/api/articles/${slug}/comments`,\n    });\n  },\n  delComment(slug, id) {\n    return request({\n      method: \"DELETE\",\n      url: `/api/articles/${slug}/comments/${id}`,\n    });\n  },\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('nav',[_vm._ssrNode(\"<ul class=\\\"pagination\\\">\"+(_vm._ssrList((_vm.pageTotal),function(index){return (\"<li\"+(_vm._ssrClass(\"page-item \",{ active: _vm.currentIndex == index }))+\"><span class=\\\"page-link ng-binding\\\">\"+_vm._ssrEscape(_vm._s(index))+\"</span></li>\")}))+\"</ul>\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  name: \"pagenation\",\n  props: {\n    total: {\n      type: Number,\n      default: 0,\n    },\n    limit: {\n      type: Number,\n      default: 20,\n    },\n  },\n  data() {\n    return {\n      currentIndex: 1,\n    };\n  },\n  methods: {\n    change(index) {\n      this.currentIndex = index;\n      this.$emit(\"changePage\", index);\n    },\n    reset() {\n        this.currentIndex = 1;\n    }\n  },\n  computed: {\n    pageTotal() {\n      return Math.ceil(this.total / this.limit);\n    },\n  },\n};\n","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./pagenation.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./pagenation.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./pagenation.vue?vue&type=template&id=2250037e&\"\nimport script from \"./pagenation.vue?vue&type=script&lang=js&\"\nexport * from \"./pagenation.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  \"56e0af66\"\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"home-page\"},[_vm._ssrNode(\"<div class=\\\"banner\\\"><div class=\\\"container\\\"><h1 class=\\\"logo-font\\\">conduit</h1> <p>A place to share your knowledge.</p></div></div> \"),_vm._ssrNode(\"<div class=\\\"container page\\\">\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"row\\\">\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"col-md-9\\\">\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"feed-toggle\\\"><ul class=\\\"nav nav-pills outline-active\\\">\"+((_vm.user)?(\"<li class=\\\"nav-item\\\"><span\"+(_vm._ssrClass(\"nav-link\",{ active: _vm.type === 'feed' }))+\">Your Feed</span></li>\"):\"<!---->\")+\" <li class=\\\"nav-item\\\"><span\"+(_vm._ssrClass(\"nav-link\",{ active: _vm.type === 'global' }))+\">Global Feed</span></li> \"+((_vm.params.tag)?(\"<li class=\\\"nav-item\\\"><span class=\\\"nav-link active\\\">\"+_vm._ssrEscape(\"# \"+_vm._s(_vm.params.tag))+\"</span></li>\"):\"<!---->\")+\"</ul></div> \"),_vm._l((_vm.articles),function(article,index){return _vm._ssrNode(\"<div class=\\\"article-preview\\\">\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"article-meta\\\">\",\"</div>\",[_c('nuxt-link',{attrs:{\"to\":(\"/profile/\" + (article.author.username))}},[_c('img',{attrs:{\"src\":article.author.image}})]),_vm._ssrNode(\" \"),_vm._ssrNode(\"<div class=\\\"info\\\">\",\"</div>\",[_c('nuxt-link',{staticClass:\"author\",attrs:{\"to\":(\"/profile/\" + (article.author.username))}},[_vm._v(_vm._s(article.author.username))]),_vm._ssrNode(\" <span class=\\\"date\\\">\"+_vm._ssrEscape(_vm._s(_vm._f(\"date\")(article.author.createdAt,'MMM DD, YYYY')))+\"</span>\")],2),_vm._ssrNode(\" <button\"+(_vm._ssrClass(\"btn btn-outline-primary btn-sm pull-xs-right\",{ active: article.favorited }))+\"><i class=\\\"ion-heart\\\"></i>\"+_vm._ssrEscape(\" \"+_vm._s(article.favoritesCount)+\"\\n            \")+\"</button>\")],2),_vm._ssrNode(\" <span class=\\\"preview-link\\\"><h1>\"+_vm._ssrEscape(_vm._s(article.title))+\"</h1> <p>\"+_vm._ssrEscape(_vm._s(article.description))+\"</p> <span>Read more...</span> <ul class=\\\"tag-list\\\">\"+(_vm._ssrList((article.tagList),function(tag,index){return (\"<li ng-repeat=\\\"tag in $ctrl.article.tagList\\\" class=\\\"tag-default tag-pill tag-outline ng-binding ng-scope\\\">\"+_vm._ssrEscape(\"\\n                \"+_vm._s(tag)+\"\\n              \")+\"</li>\")}))+\"</ul></span>\")],2)}),_vm._ssrNode(\" <div>\"+((_vm.loading)?(\"<div>loading...</div>\"):\"<!---->\")+\" \"+((!_vm.loading && _vm.articles.length == 0)?(\"<div>nothing</div>\"):\"<!---->\")+\"</div>\")],2),_vm._ssrNode(\" <div class=\\\"col-md-3\\\"><div class=\\\"sidebar\\\"><p>Popular Tags</p> <div class=\\\"tag-list\\\">\"+(_vm._ssrList((_vm.tags),function(tag){return (\"<span class=\\\"tag-pill tag-default\\\">\"+_vm._ssrEscape(_vm._s(tag))+\"</span>\")}))+\"</div></div></div>\")],2),_vm._ssrNode(\" \"),_c('Pagenation',{ref:\"pagination\",attrs:{\"total\":_vm.articlesCount,\"limit\":_vm.params.limit},on:{\"changePage\":_vm.changePage}})],2)],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { ArticleApi } from \"../utils/api/article\";\nimport { mapState } from \"vuex\";\nimport Pagenation from '@/components/pagenation'\nexport default {\n  layout: \"default\",\n  name: \"indexpage\",\n  components: {\n    Pagenation,\n  },\n  data() {\n    return {\n      tags: [],\n      type: \"global\", // global | feed\n      loading: false,\n      params: {\n        author: \"\",\n        favorited: \"\",\n        limit: 20,\n        offset: 0,\n        tag: \"\",\n      },\n    };\n  },\n  async asyncData({ route }) {\n    console.log(\"route\", route.path);\n    const { data } = await ArticleApi.articleList();\n    return data;\n  },\n  created() {\n    this.type = this.$route.params.type || \"global\";\n    this.getTags();\n  },\n  methods: {\n    async getArticles(params, type = \"global\") {\n      this.loading = true;\n      const { data } = await ArticleApi.articleList(params, type);\n      this.articles = data.articles;\n      this.articlesCount = data.articlesCount;\n      this.loading = false;\n    },\n    async getTags() {\n      const { data } = await ArticleApi.getTags();\n      this.tags = data.tags;\n    },\n    // 更改查询的 范围\n    changeArticleType(type) {\n      this.type = type;\n      this.params.tag = \"\";\n      this.params.offset = 0;\n      this.articles = [];\n      \n      this.resetPagination();\n      \n      if (type == \"feed\") {\n        const params = {\n          limit: this.params.limit,\n          offset: 0,\n        };\n        this.getArticles(params, type);\n      } else {\n        this.params.offset = 0;\n        this.getArticles(this.params, type);\n      }\n    },\n    async toFavor(article, index) {\n      let favorApiName = \"favor\";\n      if (article.favorited) {\n        favorApiName = \"unfavor\";\n      }\n      const { data } = await ArticleApi[favorApiName](article.slug);\n      if (data && data.article) {\n        this.articles.splice(index, 1, data.article);\n      }\n    },\n    resetPagination(){\n       const ref = this.$refs.pagination;\n       ref && ref.reset();\n    },\n    async changeTag(tag) {\n      this.params.tag = tag;\n      this.type = \"\";\n      this.getArticles(this.params);\n    },\n    changePage(index) {\n      this.params.offset = (index - 1) * this.params.limit;\n      this.getArticles(this.params,this.type);\n      this.articles = [];\n    },\n    toArticle(article) {\n      this.$router.push(\"/article/\" + article.slug);\n    },\n  },\n  computed: {\n    ...mapState(\"user\", [\"user\"]),\n  },\n};\n","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=db6828a6&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  \"6d4639be\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAAA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AADA;AAHA;AAOA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AADA;AAHA;AAOA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AADA;AAHA;AASA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAtFA;;;;;;;;;;ACDA;AACA;AACA;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AALA;AACA;AASA;AACA;AACA;AADA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AARA;AASA;AACA;AACA;AACA;AACA;AAJA;AA1BA;;AChBA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACrBA;AACA;AACA;;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAJA;AAYA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AA3DA;AA4DA;AAAA;AAzFA;;AC1GA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}